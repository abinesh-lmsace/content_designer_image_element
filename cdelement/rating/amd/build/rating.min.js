/**
 * Initialize the rating element results.
 *
 * @module cdelement_rating/rating
 * @copyright  2025 bdecent gmbh <https://bdecent.de>
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("cdelement_rating/rating",["core/ajax","mod_contentdesigner/elements"],(function(Ajax,Elements){return{init:function(){document.querySelectorAll(".chapters-list li.element-rating .cdelement-rating").forEach((ratingElement=>{const scalecontainer=ratingElement.querySelector(".rating-scale");scalecontainer&&scalecontainer.addEventListener("click",(event=>{const selectedoption=event.target.closest(".rating-item");if(selectedoption){var rateid=parseInt(ratingElement.dataset.rateid,10),contentdesignerid=parseInt(ratingElement.dataset.contentdesignerid,10),changerating=0!=scalecontainer.dataset.changerating,response=0!=scalecontainer.dataset.response;if(changerating||!response){var value=selectedoption.dataset.value;scalecontainer.querySelectorAll(".rating-item").forEach((option=>{option.classList.remove("selected")})),selectedoption.classList.add("selected"),Ajax.call([{methodname:"cdelement_rating_store_rating_response_result",args:{value:value,rateid:rateid,contentdesignerid:contentdesignerid},done:function(response){if(response.result&&(ratingElement.querySelector(".rating-result").innerHTML=response.result),null!==response.average){var ratingoption=ratingElement.querySelector(".rating-item[data-value='"+response.average+"']");scalecontainer.querySelectorAll(".rating-item").forEach((option=>{option.classList.remove("average")})),ratingoption.classList.add("average")}Elements.removeWarning(),Elements.refreshContent()}}])}}}))}))},disbleResulttypefield:()=>{var scale=document.querySelector("#id_elementsettingscontainer #id_scale"),resulttype=document.querySelector("#id_elementsettingscontainer #id_resulttype");null!==scale&&0==scale.value?(resulttype.querySelector('option[value="1"]').removeAttribute("disabled"),resulttype.querySelector('option[value="2"]').setAttribute("disabled",!0)):(resulttype.querySelector('option[value="1"]').setAttribute("disabled",!0),resulttype.querySelector('option[value="2"]').removeAttribute("disabled")),scale.addEventListener("change",(e=>{0==e.target.value?(resulttype.querySelector('option[value="1"]').removeAttribute("disabled"),resulttype.querySelector('option[value="2"]').setAttribute("disabled",!0)):(resulttype.querySelector('option[value="1"]').setAttribute("disabled",!0),resulttype.querySelector('option[value="2"]').removeAttribute("disabled"))}))}}}));

//# sourceMappingURL=rating.min.js.map